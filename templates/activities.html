{% extends "base.html" %}
{% block content %}

<header id="header">
  <div class="header-bar-top"></div>
  <div class="header-bar-mid"></div>
  <div class="header-bar-bot"></div>
  <img class="title" src="{{ url_for('static', filename='img/logo.svg') }}">
  {% include "login-menu.html" %}
  <a href="javascript:void(0)" id="user-account-button" onclick="openUserMenu()">
    <b>☰</b>
  </a>
</header>

<main>
  <!-- user account: start -->
  <section id="side-menu" class="user-account-menu">
    <a href="javascript:void(0)" class="close-button" onclick="closeUserMenu()">&times;</a>

    <div class="account-details">
      <!-- user not logged in -->
      {% if 'username' not in session %}
      <p id="sign-up">See what events are occurring right now</p>
      <a href="{{url_for('user_login')}}" class="login-button">Start looking</a>

      <!-- user logged in -->
      {% elif 'picture' in session %}
      <img class="account-image" src="{{session['picture']}}">
      <div  class="account-actions">
        <a href="{{url_for('make_activity')}}" class="account-actions">
          <h2>Create Activity</h2>
        </a>
      </div>
      <div class="account-options">
        <a href="#" class="account-options">Details</a>
        <a href="#" class="account-options">Events</a>
        <a href="#" class="account-options">Settings</a>
      </div>
      {% else %}
      <div  class="account-actions">
        <a href="{{url_for('make_activity')}}" class="account-actions">
          <h2>Create Activity</h2>
        </a>
      </div>
      <div class="account-options">
        <a href="#" class="account-options">Details</a>
        <a href="#" class="account-options">Events</a>
        <a href="#" class="account-options">Settings</a>
      </div>
      {% endif %}
    </div>

  </section>
  <!-- user account: end -->

  <section id="activity-container">

  {% for activity in activities %}
    <section class="activity-wrapper activity-img" style="background-image: url('{{ url_for('static', filename='img/placeholder-logo.svg') }}')">
      <a href="{{url_for('display_activity', activity_id=activity.id)}}">
        <svg class="text-path" viewBox="0 0 200 200"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink">
          <defs>
            <path
                id="TextPath"
                d="M 100,190
                   A 90,90 0 1,0 10,100" />
          </defs>
          <text class="activity-name">
            <textPath xlink:href="#TextPath">{{ activity.name }}</textPath>
          </text>
        </svg>
      </a>
    </section>
  {% endfor %}

  </section>

</main>

<footer>
  <div>
    <h6>© 2018 David Simowitz</h6>
  <div>
</footer>

<script>
  window.addEventListener("resize", adjustActivityContainerRowHeight);

  var activities = document.getElementById('activity-container');
  /*
   * Adjust each row height in 'grid-auto-rows' to match each
   * column width in 'grid-template-columns' to allow the shape
   * of each activity grid item to be set to a circle.
   */
  function adjustActivityContainerRowHeight() {
    var style = window.getComputedStyle(activities);
    // only require the width from one column
    var columnWidth =
        style.getPropertyValue('grid-template-columns').split(" ", 1);
    activities.style.gridAutoRows = columnWidth;
  };

  // Apply inital adjustment to row height
  window.onresize = adjustActivityContainerRowHeight();
</script>

<script>
  function openUserMenu() {
    document.getElementById("side-menu").style.width = "350px";
  }

  function closeUserMenu() {
    document.getElementById("side-menu").style.width = "0";
  }
</script>

{% endblock %}
